// ==UserScript==
// @name         GrammarSimplified
// @version      2024/03/07
// @author       HentaiSaru
// @description  Simple syntax simplification function
// @namespace    https://greasyfork.org/users/989635
// @match        *://*/*
// ==/UserScript==
class API{constructor(){this.ListenerRecord=new Map,this.Parser=new DOMParser,this.GM={__verify:e=>void 0!==e?e:null,set:function(e,t){GM_setValue(e,t)},get:function(e,t){return this.__verify(GM_getValue(e,t))},setjs:function(e,t){GM_setValue(e,JSON.stringify(t,null,4))},getjs:function(e,t){return JSON.parse(this.__verify(GM_getValue(e,t)))}},this.Template={log:e=>console.log(e),warn:e=>console.warn(e),error:e=>console.error(e),count:e=>console.count(e)}}$$(e,t=!1,r=document){const n=e.slice(1);switch([".","#"," ","="].some(e=>n.includes(e))?" ":e[0]){case"#":return r.getElementById(n);case" ":return t?r.querySelectorAll(e):r.querySelector(e);case".":e=r.getElementsByClassName(n);break;default:e=r.getElementsByTagName(e)}return t?Array.from(e):e[0]}DomParse(e){return this.Parser.parseFromString(e,"text/html")}IllegalCharacters(e){return e.replace(/[\/\?<>\\:\*\|":]/g,"")}ExtensionName(e){try{return e.match(/\.([^.]+)$/)[1].toLowerCase()||"png"}catch{return"png"}}WorkerCreation(e){return e=new Blob([e],{type:"application/javascript"}),new Worker(URL.createObjectURL(e))}sleep(t){return new Promise(e=>setTimeout(e,1e3*t))}async AddStyle(e,t="New-Style"){let r=document.getElementById(t);r||((r=document.createElement("style")).id=t,document.head.appendChild(r)),r.appendChild(document.createTextNode(e))}async AddScript(e,t="New-Script"){let r=document.getElementById(t);r||((r=document.createElement("script")).id=t,document.head.appendChild(r)),r.appendChild(document.createTextNode(e))}async AddListener(e,t,r,n={}){this.ListenerRecord.has(e)&&this.ListenerRecord.get(e).has(t)||(e.addEventListener(t,r,n),this.ListenerRecord.has(e)||this.ListenerRecord.set(e,new Map),this.ListenerRecord.get(e).set(t,r))}async RemovListener(e,t){var r;this.ListenerRecord.has(e)&&this.ListenerRecord.get(e).has(t)&&(r=this.ListenerRecord.get(e).get(t),e.removeEventListener(t,r),this.ListenerRecord.get(e).delete(t))}async Listen(e,t,r,n={},s=null){try{e.addEventListener(t,r,n),s&&s(!0)}catch{s&&s(!1)}}async WaitElem(e,t,r,n,s=document.body){let o,i,a;const c=new MutationObserver(()=>{i=t?document.querySelectorAll(e):document.querySelector(e),(a=t?0<i.length&&Array.from(i).every(e=>null!=e):i)&&(c.disconnect(),clearTimeout(o),n(i))});c.observe(s,{childList:!0,subtree:!0}),o=setTimeout(()=>{c.disconnect()},1e3*r)}async WaitMap(e,t,r,n=document.body){let s,o;const i=new MutationObserver(()=>{(o=e.map(e=>document.querySelector(e))).every(e=>null!==e&&"string")&&(i.disconnect(),clearTimeout(s),r(o))});i.observe(n,{childList:!0,subtree:!0}),s=setTimeout(()=>{i.disconnect()},1e3*t)}async log(e=null,t="print",r="log"){r="string"==typeof r&&this.Template[r]?r:"log",null==e?this.Template[r](t):(console.groupCollapsed(e),this.Template[r](t),console.groupEnd())}Storage(t,r,n=null){var e,s={Type:e=>Object.prototype.toString.call(e).slice(8,-1),String:e=>e?JSON.parse(e):(t.setItem(r,JSON.stringify(n)),!0),Number:e=>e?Number(e):(t.setItem(r,JSON.stringify(n)),!0),Array:e=>e?JSON.parse(e):(t.setItem(r,JSON.stringify(n)),!0),Object:e=>e?JSON.parse(e):(t.setItem(r,JSON.stringify(n)),!0),Boolean:e=>e?JSON.parse(e):(t.setItem(r,JSON.stringify(n)),!0),Date:e=>e?new Date(e):(t.setItem(r,JSON.stringify(n)),!0),Map:e=>e?new Map(JSON.parse(e)):(t.setItem(r,JSON.stringify([...n])),!0)};return null!=n?s[s.Type(n)]():!!(e=t.getItem(r))&&s[s.Type(JSON.parse(e))](e)}store(e,t,r=null){switch(e[0]){case"g":return this.GM[e](t,r);case"s":return null!==r?this.GM[e](t,r):null;default:return Error("wrong type of operation")}}async Menu(e){for(const[t,r]of Object.entries(e))GM_registerMenuCommand(t,()=>{r()})}}